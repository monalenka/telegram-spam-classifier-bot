# Telegram Anti-spam bot с ML-классификатором
Telegram-бот для автоматического обнаружения и модерации спама в группах с использованием машинного обучения. Модель была обучена на самостоятельно собранных русскоязычных данных.

## Возможности

### Автоматическое обнаружение спама
- **ML-модель**: логистическая регрессия с TF-IDF векторизацией
- **Точность**: общая точность - 95%
- **Особенности**: анализ текста, длины сообщения, количества восклицательных знаков, цифр и ключевых слов
### Переклюяение режимов модерации
1. **Автоудаление**: мгновенное удаление сообщений, определенных как спам
2. **Голосование**: создание опроса "СПАМ?" с кнопками голосования для остальных пользователей группы (удаление при достижении порога голосов)
### Шаблонные темы
Принудительное соблюдение формата сообщений в определенных темах
### Гибкие настройки
- настройка режимов через приватный чат с ботом
- отдельные настройки для каждой группы
- автоматическое удаление подсказок через  установленное время
### Аналитика
- автоматическое сохранение результатов голосования в CSV
- возможность ручного удалегия сообщений командой `/delete`
- сбор данных для дообучения модели


## Архитектура проекта

```
spam_classifier/
├── src/
│   ├── preprocessing.py
│   ├── train_model.py
│   ├── evaluate.py
│   └── utils.py
├── bot/
│   └── telegram_bot.py
├── data/
│   ├── raw/
│   └── processed/
├── models/ 
└── results/
```


## Технологии

- **Python 3.10+**
- **Machine Learning**: scikit-learn, pandas, numpy
- **NLP**: TF-IDF векторизация, PyMorphy2 для лематизации
- **Telegram Bot API**: python-telegram-bot
- **Обработка текста**: регулярные выражения, очистка данных
- **Хранение данных**: CSV, joblib для моделей


## Руководство к установке и запуску

### 1. Клонирование репозитория
```bash
git clone https://github.com/your-username/spam_classifier.git
cd spam_classifier
```
### 2. Установка зависимостей
```bash
pip install -r requirements.txt
```
### 3. Настройка переменных окружения
Необходимо создать файл `.env` в корне проекта:
```
TELEGRAM_BOT_TOKEN=your_bot_token_here
```
### 4. Подготовка данных и обучение модели
```bash
python combine_data.py

python src/train_model.py

python src/evaluate.py
```
### 5. Запуск бота
```bash
python bot/telegram_bot.py
```

## Использование!!

### Настройте бот в группе
1. Добавьте бота в группу и назначьте администратором
2. Напишите боту в личку `/start`
3. Выберите `/settings` → `/spamsettings`
4. Выберите группу и режим модерации

### Настройка шаблонных тем
1. В нужной теме отправьте команду `/settemplate`
2. Настройте способ подсказок через `/settings` → `/templatehintsettings`

### Ручное удаление спама
Ответьте на спам-сообшение командой `/delete` (только для администраторов)


## Качество модели

Модель показывает следующую точность на русскоязычных данных:

<img width="974" height="380" alt="image" src="https://github.com/user-attachments/assets/b80a79f0-b016-447c-bbc6-ce5cd3d159e1" />


## Кастомизация

Так как данный телеграм-бот был создан под конкретную группу и не-спам-сообщения были извлечены из нее, база данных может не подойти под вашу группу из-за специфики ham-сообщений и значения precision и recall для ham могут быть ниже (в отличие от spam-показателей, которые все же имеют более устойчивый формат). Рекомендую подобрать свои данные. Кроме того, функции в моем боте тоже выбраны для удобства именно в этой группе и, предполагаю, для своего пользования вы тоже захотите их поменять.

### Изменение порога голосования
В файле `bot/telegram_bot.py` измените значение `VOTE_THRESHOLD`

### Добавление новых признаков
Модифицируйте функцию `extract_features()` в `src/preprocessing.py`

### Изменение шаблона для тем
Поменяйте регулярное выражение `TEMPLATE_REGEX` в `bot/telegram_bot.py`

### Дообучение модели
Используйте собранные данные из `bot_votes.csv` для улучшения модели



## Мониторинг

- результаты голосования сохраняются в `bot_votes.csv`
- матрица ошибок сохраняется в `results/confusion_matrix.png`
- в `results/Отчёты.docx` зафиксирован путь исправления показателей модели для достижения наибольшей точности (возможно, кому-то интересно)



## Автор

**Лена** - [GitHub](https://github.com/monalenka)



Буду рада критике, рекомендациям и отзывам!



**topics**
telegram-bot  machine-learning  spam-detection  nlp  python  scikit-learn  tf-idf  logistic-regression  russian-language  text-classification  moderation  chat-bot  ai  ml  data-science  telegram-api  python-telegram-bot  text-processing  feature-extraction  confusion-matrix  model-evaluation 

